# v1.3.4 - Enhanced Card Social Share Images with Talk Integration ðŸŽ´

**Released:** January 29, 2026

## Summary

Major upgrade to card social share images. Each card's OG image now showcases the primary mapped TED talk alongside the card, making social shares more informative and engaging. Features OpenDyslexic font, unique starfields per card, and platform-safe layout.

## Features

### Layout A3 Design
- **Brand**: TarotTALKS logo in top-left corner (baseline-aligned)
- **Talk Section**: Primary mapped TED talk at bottom-left
  - Large thumbnail (300x150)
  - Talk title
  - Speaker name
- **Card Info**: Right-justified, vertically centered
  - Card name (uppercase, 48px)
  - Full summary text
  - Up to 4 keyword pills
- **Card Image**: Full artwork on right side (260x514)

### OpenDyslexic Font
- Custom font loaded for all text
- Improves readability and accessibility
- Graceful fallback to system fonts if loading fails

### Unique Starfields
- Each card has its own unique sparkle pattern
- Seeded random generation from card slug
- 12-15 stars per card with varied sizes (3-5px) and opacity (0.4-0.9)
- Deterministic: same card always gets same stars

### Platform Safe Buffer
- 80px bottom padding to avoid Twitter/X overlay
- Talk info positioned above the overlay zone
- Reduced thumbnail height (150px) to fit within safe area

## Technical Implementation

### Files Modified
- `app/cards/[slug]/twitter-image.tsx` - Twitter/X and Bluesky images
- `app/cards/[slug]/opengraph-image.tsx` - Facebook, LinkedIn, and other OG platforms

### Key Changes
- `getCardWithMappings()` query to fetch primary talk data
- `loadFonts()` async function with error handling
- `generateSparkles(slug)` seeded random sparkle generator
- Layout restructured for talk + card content

### Font Loading
```typescript
async function loadFonts() {
  const [regularRes, boldRes] = await Promise.all([
    fetch('https://tarottalks.app/fonts/OpenDyslexic-Regular.woff'),
    fetch('https://tarottalks.app/fonts/OpenDyslexic-Bold.woff'),
  ]);
  // Returns ArrayBuffer for ImageResponse fonts option
}
```

### Sparkle Generation
```typescript
function generateSparkles(slug: string) {
  // Hash slug to create seed
  // Seeded random for deterministic output
  // Generate 12-15 sparkles with random x, y, size, opacity
}
```

## Before & After

**Before (v1.3.3)**:
- Card image + name + summary + keywords
- Static sparkle positions (same for all cards)
- System fonts
- No talk information

**After (v1.3.4)**:
- Card image + name + summary + keywords
- Primary mapped TED talk thumbnail + title + speaker
- Unique sparkle pattern per card
- OpenDyslexic font
- Platform-safe layout (no content blocked by overlays)

## Testing

1. Share card URLs on Twitter/X - talk info visible, speaker name not blocked
2. Share on Bluesky - same branded image with talk
3. Share on Facebook/LinkedIn - OG image shows talk integration
4. Compare different cards - each has unique starfield
5. Direct image URLs: `/cards/{slug}/twitter-image`

## Notes

- Cards without a primary talk mapping will show layout without talk section
- Talk thumbnails fetched from Supabase Storage
- Images generated on-demand at runtime
- Font loading has graceful fallback to system fonts
